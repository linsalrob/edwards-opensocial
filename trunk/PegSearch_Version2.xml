<?xml version="1.0" encoding="UTF-8"?>
<Module>

<ModulePrefs
		title="PEG Search"
		directory_title="Edwards Lab PEG Search"
		title_url=""
		description="PEG Search"
		author="Vasken K. and Matt S."
		author_affiliation="SDSU"
		author_location="San Diego, CA"
		author_email="skinien@cox.net"
		screenshot=""
		thumbnail="http://i74.photobucket.com/albums/i261/skinien/SDSU.jpg"
		height="200"
		width="200"
		scrolling="true"
		render_inline="optional"
		category="tools">
		<Require feature="opensocial-0.7" />
</ModulePrefs>

<Content type="html">
  
<![CDATA[
<script type="text/javascript" src="Prototype.js"></script>
<script type="text/javascript" src="ws_update.js"></script>
<script language="Javascript" type="text/javascript">
/****************************************************************************/
var peg = 'fig|83333.1.peg.1345';
var result = '';
  
function getTranslation (peg, container) {
	var call = new WS.Call('FIG/wsdl_seed.cgi'); 
	var nsuri = 'http://ws.nmpdr.org/';
	var qn_op = new WS.QName('get_translationRequest',nsuri);
	var qn_op_resp = new WS.QName('get_translationResponse',nsuri);
	
	var MyHandler = Class.create();
	Object.extend(MyHandler.prototype, WS.Handler.prototype);
	Object.extend(MyHandler.prototype,({
  		on_request : function(envelope) {
     		alert('SOAPHANDLER: PRE');
  		},
  		on_response : function(call,envelope) {
     		alert('SOAPHANDLER: POST');
  		},
  		on_error : function(call,envelope) {
  			alert('SOAPHANDLER: ERROR');
  		}
	}));
		
	call.add_handler(new MyHandler());	
		
	call.invoke_rpc(
	  qn_op,
	  new Array(
	    {name:'peg',value:peg}
	   ),SOAP.NOENCODING,
	   function(call,envelope) {
	     var ret = 
	       envelope.get_body().get_all_children()[0].
	         get_all_children()[0].get_value();
	     container.innerHTML = ret;
	     $('soap').innerHTML = arguments[2].escapeHTML();
	   }
	);
}

try {
	getTranslation(peg, result);
} catch(e) {
	alert(e);
}

alert('END OF FILE');
/******************************************************************************/
</script>]]>

</Content>
</Module>
